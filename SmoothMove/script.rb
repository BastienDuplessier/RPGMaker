#--------------------------------------------------------------------------
# * Mouvement souples
#--------------------------------------------------------------------------

#==============================================================================
# ** MoveConfig
#------------------------------------------------------------------------------
#  Configuration
#==============================================================================

module MoveConfig
  #--------------------------------------------------------------------------
  # * Delai de déplacement
  #--------------------------------------------------------------------------
  DELAY = 7
end  

#==============================================================================
# ** Game_Player
#------------------------------------------------------------------------------
#  Modification du déplacement
#==============================================================================

class Game_Player
  #--------------------------------------------------------------------------
  # * Alias
  #--------------------------------------------------------------------------
  alias :smooth_update :update
  alias :smooth_initialize :initialize
  #--------------------------------------------------------------------------
  # * Constructeur
  #--------------------------------------------------------------------------
  def initialize
    @wait_rest = MoveConfig::DELAY
    smooth_initialize
  end
  #--------------------------------------------------------------------------
  # * Update
  #--------------------------------------------------------------------------
  def update
    smooth_update
    @wait_rest -= 1 if @wait_rest > 0
  end
  #--------------------------------------------------------------------------
  # * Déplacement au clavier
  #--------------------------------------------------------------------------
  def move_by_input
    return if !movable? || $game_map.interpreter.running?
    keys = {
      2 => :DOWN, 
      4 => :LEFT, 
      6 => :RIGHT, 
      8 => :UP
    }
    dir = Input.dir4
    if dir > 0 
      key = keys[dir]
      if(Input.trigger?(key))
        @wait_rest = MoveConfig::DELAY
        set_direction(dir)
      elsif @wait_rest == 0
        move_straight(dir, true)
      end
    end
  end
end
